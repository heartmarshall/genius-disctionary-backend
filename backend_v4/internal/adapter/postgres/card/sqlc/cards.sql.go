// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: cards.sql

package sqlc

import (
	"context"
	"time"

	"github.com/google/uuid"
)

const createCard = `-- name: CreateCard :one
INSERT INTO cards (id, user_id, entry_id, state, due, created_at, updated_at)
VALUES ($1, $2, $3, 'NEW', now(), $4, $5)
RETURNING id, user_id, entry_id, state, step, stability, difficulty,
          due, last_review, reps, lapses, scheduled_days, elapsed_days,
          created_at, updated_at
`

type CreateCardParams struct {
	ID        uuid.UUID
	UserID    uuid.UUID
	EntryID   uuid.UUID
	CreatedAt time.Time
	UpdatedAt time.Time
}

type CreateCardRow struct {
	ID            uuid.UUID
	UserID        uuid.UUID
	EntryID       uuid.UUID
	State         CardState
	Step          int32
	Stability     float64
	Difficulty    float64
	Due           time.Time
	LastReview    *time.Time
	Reps          int32
	Lapses        int32
	ScheduledDays int32
	ElapsedDays   int32
	CreatedAt     time.Time
	UpdatedAt     time.Time
}

func (q *Queries) CreateCard(ctx context.Context, arg CreateCardParams) (CreateCardRow, error) {
	row := q.db.QueryRow(ctx, createCard,
		arg.ID,
		arg.UserID,
		arg.EntryID,
		arg.CreatedAt,
		arg.UpdatedAt,
	)
	var i CreateCardRow
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.EntryID,
		&i.State,
		&i.Step,
		&i.Stability,
		&i.Difficulty,
		&i.Due,
		&i.LastReview,
		&i.Reps,
		&i.Lapses,
		&i.ScheduledDays,
		&i.ElapsedDays,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const deleteCard = `-- name: DeleteCard :execrows
DELETE FROM cards
WHERE id = $1 AND user_id = $2
`

type DeleteCardParams struct {
	ID     uuid.UUID
	UserID uuid.UUID
}

func (q *Queries) DeleteCard(ctx context.Context, arg DeleteCardParams) (int64, error) {
	result, err := q.db.Exec(ctx, deleteCard, arg.ID, arg.UserID)
	if err != nil {
		return 0, err
	}
	return result.RowsAffected(), nil
}

const getCardByEntryID = `-- name: GetCardByEntryID :one
SELECT id, user_id, entry_id, state, step, stability, difficulty,
       due, last_review, reps, lapses, scheduled_days, elapsed_days,
       created_at, updated_at
FROM cards
WHERE entry_id = $1 AND user_id = $2
`

type GetCardByEntryIDParams struct {
	EntryID uuid.UUID
	UserID  uuid.UUID
}

type GetCardByEntryIDRow struct {
	ID            uuid.UUID
	UserID        uuid.UUID
	EntryID       uuid.UUID
	State         CardState
	Step          int32
	Stability     float64
	Difficulty    float64
	Due           time.Time
	LastReview    *time.Time
	Reps          int32
	Lapses        int32
	ScheduledDays int32
	ElapsedDays   int32
	CreatedAt     time.Time
	UpdatedAt     time.Time
}

func (q *Queries) GetCardByEntryID(ctx context.Context, arg GetCardByEntryIDParams) (GetCardByEntryIDRow, error) {
	row := q.db.QueryRow(ctx, getCardByEntryID, arg.EntryID, arg.UserID)
	var i GetCardByEntryIDRow
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.EntryID,
		&i.State,
		&i.Step,
		&i.Stability,
		&i.Difficulty,
		&i.Due,
		&i.LastReview,
		&i.Reps,
		&i.Lapses,
		&i.ScheduledDays,
		&i.ElapsedDays,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getCardByID = `-- name: GetCardByID :one

SELECT id, user_id, entry_id, state, step, stability, difficulty,
       due, last_review, reps, lapses, scheduled_days, elapsed_days,
       created_at, updated_at
FROM cards
WHERE id = $1 AND user_id = $2
`

type GetCardByIDParams struct {
	ID     uuid.UUID
	UserID uuid.UUID
}

type GetCardByIDRow struct {
	ID            uuid.UUID
	UserID        uuid.UUID
	EntryID       uuid.UUID
	State         CardState
	Step          int32
	Stability     float64
	Difficulty    float64
	Due           time.Time
	LastReview    *time.Time
	Reps          int32
	Lapses        int32
	ScheduledDays int32
	ElapsedDays   int32
	CreatedAt     time.Time
	UpdatedAt     time.Time
}

// ---------------------------------------------------------------------------
// cards (FSRS-5)
// ---------------------------------------------------------------------------
func (q *Queries) GetCardByID(ctx context.Context, arg GetCardByIDParams) (GetCardByIDRow, error) {
	row := q.db.QueryRow(ctx, getCardByID, arg.ID, arg.UserID)
	var i GetCardByIDRow
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.EntryID,
		&i.State,
		&i.Step,
		&i.Stability,
		&i.Difficulty,
		&i.Due,
		&i.LastReview,
		&i.Reps,
		&i.Lapses,
		&i.ScheduledDays,
		&i.ElapsedDays,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateCardSRS = `-- name: UpdateCardSRS :one
UPDATE cards
SET state = $1,
    step = $2,
    stability = $3,
    difficulty = $4,
    due = $5,
    last_review = $6,
    reps = $7,
    lapses = $8,
    scheduled_days = $9,
    elapsed_days = $10,
    updated_at = now()
WHERE id = $11 AND user_id = $12
RETURNING id, user_id, entry_id, state, step, stability, difficulty,
          due, last_review, reps, lapses, scheduled_days, elapsed_days,
          created_at, updated_at
`

type UpdateCardSRSParams struct {
	State         CardState
	Step          int32
	Stability     float64
	Difficulty    float64
	Due           time.Time
	LastReview    *time.Time
	Reps          int32
	Lapses        int32
	ScheduledDays int32
	ElapsedDays   int32
	ID            uuid.UUID
	UserID        uuid.UUID
}

type UpdateCardSRSRow struct {
	ID            uuid.UUID
	UserID        uuid.UUID
	EntryID       uuid.UUID
	State         CardState
	Step          int32
	Stability     float64
	Difficulty    float64
	Due           time.Time
	LastReview    *time.Time
	Reps          int32
	Lapses        int32
	ScheduledDays int32
	ElapsedDays   int32
	CreatedAt     time.Time
	UpdatedAt     time.Time
}

func (q *Queries) UpdateCardSRS(ctx context.Context, arg UpdateCardSRSParams) (UpdateCardSRSRow, error) {
	row := q.db.QueryRow(ctx, updateCardSRS,
		arg.State,
		arg.Step,
		arg.Stability,
		arg.Difficulty,
		arg.Due,
		arg.LastReview,
		arg.Reps,
		arg.Lapses,
		arg.ScheduledDays,
		arg.ElapsedDays,
		arg.ID,
		arg.UserID,
	)
	var i UpdateCardSRSRow
	err := row.Scan(
		&i.ID,
		&i.UserID,
		&i.EntryID,
		&i.State,
		&i.Step,
		&i.Stability,
		&i.Difficulty,
		&i.Due,
		&i.LastReview,
		&i.Reps,
		&i.Lapses,
		&i.ScheduledDays,
		&i.ElapsedDays,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}
